{% load static %}
 <title>{% block titulo %}Lista de pagos {% endblock titulo %}</title>
{% include "header.html" %}
    {% include "nav.html" %}
 <body class="vw-100 vh-100" style="">
  <div class="modal-dialog modal-dialog-scrollable" role="document">
    <div class="modal-content">
        <header class="modal-header " style="background-color: #FFc107;color:#fff;">Cambiar contrase√±a</header>
      
  <div
      class="container w-100 d-flex justify-content-center align-items-center"
    >

        <form action="{% url 'change-password' id %}" method="POST">
            <div class="modal-body" style="width: 100%; overflow-y: auto;">
            {% csrf_token %}
                {{ form.as_p }} 
          
            </div>

            <div class="d-flex justify-content-center">
                <button class="btn btn-outline-primary btn-flat" type="submit"><i class="fas fa-save "></i> Guardar</button>
                &nbsp;
               <button class="btn btn-outline-danger btn-flat" onclick="return location.reload(true)" type="button"><i class="fas fa-times"></i> Cancelar</button>
            </div>
            <br>
        </form>
        </div>
        </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>


  <script src="/static/js/jquery-3.1.1.min.js"></script>
  <script src="/static/pantallap/lib/bootstrap/js/bootstrap.min.js"></script>
  <script class="include" type="text/javascript" src="/static/pantallap/lib/jquery.dcjqaccordion.2.7.js"></script>
  <script src="/static/pantallap/lib/jquery.scrollTo.min.js"></script>
  <script src="/static/pantallap/lib/jquery.nicescroll.js" type="text/javascript"></script>

  <script src="http://maps.google.com/maps/api/js?sensor=false&libraries=geometry&v=3.7"></script>
  <script src="/static/pantallap/lib/google-maps/maplace.js"></script>
  <script src="/static/pantallap/lib/google-maps/data/points.js"></script>

  <script src="/static/pantallap/lib/bootstrap/js/bootstrap.min.js"></script>
  <script class="include" type="text/javascript" src="/static/pantallap/lib/jquery.dcjqaccordion.2.7.js"></script>
  <script src="/static/pantallap/lib/jquery.scrollTo.min.js"></script>
  <script src="/static/pantallap/lib/jquery.nicescroll.js" type="text/javascript"></script>
  <script src="/static/pantallap/lib/jquery.sparkline.js"></script>
  <script src="/static/pantallap/lib/common-scripts.js" ></script>
  <script type="text/javascript" src="/static/pantallap/lib/gritter/js/jquery.gritter.js"></script>
  <script type="text/javascript" src="/static/pantallap/lib/gritter-conf.js"></script>
  <script src="/static/pantallap/lib/sparkline-chart.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery-match-height@0.7.2/dist/jquery.matchHeight.min.js"></script>
  <script src="/static/lib/sweetalert2-9.10.0/sweetalert2.all.min.js"></script>
  <script src="/static/lib/adminlte-3.0.4/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/static/lib/adminlte-3.0.4/js/adminlte.min.js"></script>
  <script src="/static/main.js"></script>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="/static/lib/jquery-confirm-v3.3.4/jquery-confirm.min.js"></script>    
  <script type="text/javascript" src="https://cdn.datatables.net/v/bs5/dt-1.10.25/af-2.3.7/b-1.7.1/rr-1.2.8/sp-1.3.0/datatables.min.js"></script>
  </body>
</html>
 

<script>
       
    $(function(){
        function messageError(text){
            Swal.fire({
            title:'ERRROR',
            html: '<pre style="text-align: initial !important;">' + text + '</pre>',
            icon:'error',
            confirmButtonColor:'#d33',
            confirmButtonText:'Aceptar'
        })}
        var url=$("form").attr("action")
        var token=$("[name=csrfmiddlewaretoken]").val()
        console.log(url)
        $("form").submit(function(e){
            e.preventDefault()
            let formdata=$("form").serializeArray()
            console.log(formdata)
            $.ajax({
                method: "POST",
                url: url,
                data: formdata,
                headers:{'X-CSRFToken':token},
                }).done(function(r,textStatus,xhr){
                    console.log(r)
                    console.log(textStatus)
                    console.log(xhr)
                if(xhr.status==200){
                    location.reload(true);
                }else{
                    console.log("text",textStatus)
                    messageError(textStatus);
                }
               
            }).fail(function(error){               
                let ar=JSON.parse(error.responseText)              
                console.log(ar)               
                let obe = Object.values(ar);
             
                let mensaje=""
                for (var k in obe) {
                    if ((Number(k) + 1) === obe.length) {
                        mensaje+="- "+obe[k][0]
                    }else{
                    mensaje+= "- "+obe[k][0]+"\n"

                    }
                    
                }
                
               
                 messageError(mensaje)
                
            });
        })
    })

     
</script>
